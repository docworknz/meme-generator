(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"warnOnce",{enumerable:!0,get:function(){return r}});let r=e=>{}},67271,e=>{"use strict";var t=e.i(43476),s=e.i(8896),r=e.i(25045),i=e.i(86608);e.i(50766);var a=e.i(2909);function d(){let e=s.db.useUser(),{isLoading:r,error:i,data:d}=s.db.useQuery({memes:{image:{},author:{},upvotes:{$user:{}},$:{order:{serverCreatedAt:"desc"}}}});if(r)return(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[40vh]",children:(0,t.jsx)("p",{className:"text-[var(--muted)]",children:"Loading..."})});if(i)return(0,t.jsxs)("div",{className:"p-4 text-red-400",children:["Error: ",i.message]});let l=d?.memes??[],n=async t=>{if(!e?.id)return;let r=l.find(e=>e.id===t);if(!r?.upvotes)return;let i=r.upvotes.find(t=>t.$user?.id===e.id);if(i)await s.db.transact(s.db.tx.upvotes[i.id].delete());else{let r=(0,a.id)();await s.db.transact(s.db.tx.upvotes[r].update({}).link({meme:t,$user:e.id}))}};return(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[(0,t.jsx)("h1",{className:"text-lg font-semibold text-[var(--text)] mb-4",children:"Gallery"}),0===l.length?(0,t.jsx)("p",{className:"text-[var(--muted)]",children:"No memes yet. Create one from the Create page."}):(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:l.map(s=>{let r=s.image?.url,i=s.upvotes?.length??0,a=s.upvotes?.some(t=>t.$user?.id===e?.id);return(0,t.jsxs)("article",{className:"rounded-xl border border-[var(--border)] bg-[var(--surface)] overflow-hidden",children:[r?(0,t.jsx)("img",{src:r,alt:"Meme",className:"w-full aspect-auto object-contain bg-[#1a1a1a]"}):(0,t.jsx)("div",{className:"w-full aspect-video bg-[#2a2a2a] flex items-center justify-center text-[var(--muted)] text-sm",children:"Loading image..."}),(0,t.jsx)("div",{className:"p-3 flex items-center justify-between",children:(0,t.jsxs)("button",{type:"button",onClick:()=>n(s.id),disabled:!e?.id,className:`flex items-center gap-1.5 text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${a?"text-[var(--accent)]":"text-[var(--muted)] hover:text-[var(--text)]"}`,title:e?a?"Remove upvote":"Upvote":"Sign in to upvote",children:[(0,t.jsx)("span",{className:"tabular-nums",children:i}),(0,t.jsx)("span",{children:"upvote"})]})})]},s.id)})})]})}function l(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.db.SignedIn,{children:(0,t.jsx)(r.AppShell,{children:(0,t.jsx)(d,{})})}),(0,t.jsx)(s.db.SignedOut,{children:(0,t.jsx)(i.Login,{})})]})}e.s(["default",()=>l])}]);