{"version":3,"sources":["../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/app-router-context.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-server-dom-turbopack-client.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/hooks-client-context.ts","../../../../node_modules/next/src/server/route-modules/app-page/vendored/contexts/server-inserted-html.ts","../../../../node_modules/next/src/server/route-modules/app-page/module.compiled.js","../../../../node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.ts","../../../../app/gallery/page.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].AppRouterContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactServerDOMTurbopackClient\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].HooksClientContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].ServerInsertedHtml\n","if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxRuntime\n","\"use client\";\n\nimport { db } from \"@/lib/db\";\nimport { AppShell } from \"../components/AppShell\";\nimport { Login } from \"../components/Login\";\nimport { id } from \"@instantdb/react\";\n\nfunction GalleryContent() {\n  const user = db.useUser();\n  const { isLoading, error, data } = db.useQuery({\n    memes: {\n      image: {},\n      author: {},\n      upvotes: { $user: {} },\n      $: { order: { serverCreatedAt: \"desc\" } },\n    },\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-[40vh]\">\n        <p className=\"text-[var(--muted)]\">Loading...</p>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"p-4 text-red-400\">\n        Error: {error.message}\n      </div>\n    );\n  }\n\n  const memes = data?.memes ?? [];\n\n  const toggleUpvote = async (memeId: string) => {\n    if (!user?.id) return;\n    const meme = memes.find((m) => m.id === memeId);\n    if (!meme?.upvotes) return;\n    const existing = meme.upvotes.find(\n      (u: { $user?: { id: string } }) => u.$user?.id === user.id\n    );\n    if (existing) {\n      await db.transact(db.tx.upvotes[existing.id].delete());\n    } else {\n      const upvoteId = id();\n      await db.transact(\n        db.tx.upvotes[upvoteId].update({}).link({ meme: memeId, $user: user.id })\n      );\n    }\n  };\n\n  return (\n    <div className=\"max-w-4xl mx-auto px-4 py-6\">\n      <h1 className=\"text-lg font-semibold text-[var(--text)] mb-4\">Gallery</h1>\n      {memes.length === 0 ? (\n        <p className=\"text-[var(--muted)]\">No memes yet. Create one from the Create page.</p>\n      ) : (\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n          {memes.map((meme) => {\n            const imageUrl = meme.image?.url;\n            const upvoteCount = meme.upvotes?.length ?? 0;\n            const hasUpvoted = meme.upvotes?.some(\n              (u: { $user?: { id: string } }) => u.$user?.id === user?.id\n            );\n            return (\n              <article\n                key={meme.id}\n                className=\"rounded-xl border border-[var(--border)] bg-[var(--surface)] overflow-hidden\"\n              >\n                {imageUrl ? (\n                  <img\n                    src={imageUrl}\n                    alt=\"Meme\"\n                    className=\"w-full aspect-auto object-contain bg-[#1a1a1a]\"\n                  />\n                ) : (\n                  <div className=\"w-full aspect-video bg-[#2a2a2a] flex items-center justify-center text-[var(--muted)] text-sm\">\n                    Loading image...\n                  </div>\n                )}\n                <div className=\"p-3 flex items-center justify-between\">\n                  <button\n                    type=\"button\"\n                    onClick={() => toggleUpvote(meme.id)}\n                    disabled={!user?.id}\n                    className={`flex items-center gap-1.5 text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${\n                      hasUpvoted\n                        ? \"text-[var(--accent)]\"\n                        : \"text-[var(--muted)] hover:text-[var(--text)]\"\n                    }`}\n                    title={user ? (hasUpvoted ? \"Remove upvote\" : \"Upvote\") : \"Sign in to upvote\"}\n                  >\n                    <span className=\"tabular-nums\">{upvoteCount}</span>\n                    <span>upvote</span>\n                  </button>\n                </div>\n              </article>\n            );\n          })}\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default function GalleryPage() {\n  return (\n    <>\n      <db.SignedIn>\n        <AppShell>\n          <GalleryContent />\n        </AppShell>\n      </db.SignedIn>\n      <db.SignedOut>\n        <Login />\n      </db.SignedOut>\n    </>\n  );\n}\n"],"names":["module","exports","require","vendored","React","AppRouterContext","ReactServerDOMTurbopackClient","HooksClientContext","ServerInsertedHtml","process","env","NEXT_RUNTIME","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","ReactJsxRuntime"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6]}